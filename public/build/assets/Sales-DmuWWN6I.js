import{M as f}from"./bootstrap-DDJ2Weqf.js";import{s as p}from"./saleService-CiGuVxoJ.js";import{d as i,e as t,n as d,m as b,F as m,i as g,g as h,t as o,o as r}from"./vendor-D4pjJ2_S.js";import{_ as y}from"./app-9iDwT7xO.js";import"./api-DPQzmjXj.js";const v={name:"Sales",data(){return{sales:[],loading:!1,filter:"all",pagination:{current_page:1,last_page:1,per_page:15,total:0},selectedSale:null,detailsModalInstance:null}},computed:{visiblePages(){const n=[],e=this.pagination.current_page,u=this.pagination.last_page;for(let c=Math.max(1,e-2);c<=Math.min(u,e+2);c++)n.push(c);return n}},mounted(){this.fetchSales(),this.detailsModalInstance=new f(this.$refs.detailsModal)},methods:{async fetchSales(n=1){this.loading=!0;try{const e={page:n};this.filter!=="all"&&(e.filter=this.filter);const u=await p.getAll(e);this.sales=u.data,this.pagination={current_page:u.current_page,last_page:u.last_page,per_page:u.per_page,total:u.total}}catch(e){console.error("Error fetching sales:",e)}finally{this.loading=!1}},setFilter(n){this.filter=n,this.fetchSales(1)},changePage(n){n>=1&&n<=this.pagination.last_page&&this.fetchSales(n)},async viewDetails(n){try{const e=await p.getById(n.id);this.selectedSale=e,this.detailsModalInstance.show()}catch(e){console.error("Error fetching sale details:",e)}},formatDate(n){return new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},formatNumber(n){return parseFloat(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}}},k={class:"container-fluid py-4"},S={class:"row mb-4"},x={class:"col-md-6"},C={class:"btn-group float-end",role:"group"},w={class:"card shadow-sm"},D={class:"card-body"},M={key:0,class:"text-center py-5"},N={key:1,class:"text-center py-5"},P={key:2,class:"table-responsive"},F={class:"table table-hover"},T=["onClick"],I={class:"badge bg-secondary"},L={class:"fw-bold"},U={key:3,class:"mt-3"},B={class:"pagination justify-content-center"},E=["onClick"],V={class:"modal fade",id:"saleDetailsModal",tabindex:"-1",ref:"detailsModal"},W={class:"modal-dialog modal-lg"},A={class:"modal-content"},j={key:0,class:"modal-body"},q={class:"row mb-3"},z={class:"col-md-6"},H={class:"col-md-6"},Q={class:"table table-sm"},G={class:"row mt-4"},J={class:"col-md-6 offset-md-6"},K={class:"table table-sm"},O={class:"text-end"},R={class:"text-end"},X={class:"table-light"},Y={class:"text-end fw-bold"};function Z(n,e,u,c,l,a){return r(),i("div",k,[t("div",S,[e[6]||(e[6]=t("div",{class:"col-md-6"},[t("h2",{class:"fw-bold"},"Sales History")],-1)),t("div",x,[t("div",C,[t("button",{type:"button",class:d(["btn btn-outline-primary",{active:l.filter==="today"}]),onClick:e[0]||(e[0]=s=>a.setFilter("today"))}," Today ",2),t("button",{type:"button",class:d(["btn btn-outline-primary",{active:l.filter==="week"}]),onClick:e[1]||(e[1]=s=>a.setFilter("week"))}," This Week ",2),t("button",{type:"button",class:d(["btn btn-outline-primary",{active:l.filter==="month"}]),onClick:e[2]||(e[2]=s=>a.setFilter("month"))}," This Month ",2),t("button",{type:"button",class:d(["btn btn-outline-primary",{active:l.filter==="all"}]),onClick:e[3]||(e[3]=s=>a.setFilter("all"))}," All ",2)])])]),t("div",w,[t("div",D,[l.loading?(r(),i("div",M,[...e[7]||(e[7]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2"},"Loading sales...",-1)])])):l.sales.length===0?(r(),i("div",N,[...e[8]||(e[8]=[t("i",{class:"bi bi-receipt fs-1 text-muted"},null,-1),t("p",{class:"mt-3 text-muted"},"No sales found",-1)])])):(r(),i("div",P,[t("table",F,[e[9]||(e[9]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Date"),t("th",null,"Customer"),t("th",null,"Items"),t("th",null,"Total"),t("th",null,"Payment Method")])],-1)),t("tbody",null,[(r(!0),i(m,null,g(l.sales,s=>(r(),i("tr",{key:s.id,onClick:_=>a.viewDetails(s),style:{cursor:"pointer"}},[t("td",null,o(a.formatDate(s.created_at)),1),t("td",null,o(s.customer_name||"Walk-in Customer"),1),t("td",null,[t("span",I,o(s.items_count)+" items",1)]),t("td",L,"৳"+o(a.formatNumber(s.total_amount)),1),t("td",null,[t("span",{class:d(["badge",s.payment_method==="cash"?"bg-success":"bg-primary"])},o(s.payment_method.toUpperCase()),3)])],8,T))),128))])])])),l.pagination.last_page>1?(r(),i("nav",U,[t("ul",B,[t("li",{class:d(["page-item",{disabled:l.pagination.current_page===1}])},[t("button",{class:"page-link",onClick:e[4]||(e[4]=s=>a.changePage(l.pagination.current_page-1))}," Previous ")],2),(r(!0),i(m,null,g(a.visiblePages,s=>(r(),i("li",{key:s,class:d(["page-item",{active:s===l.pagination.current_page}])},[t("button",{class:"page-link",onClick:_=>a.changePage(s)},o(s),9,E)],2))),128)),t("li",{class:d(["page-item",{disabled:l.pagination.current_page===l.pagination.last_page}])},[t("button",{class:"page-link",onClick:e[5]||(e[5]=s=>a.changePage(l.pagination.current_page+1))}," Next ")],2)])])):b("",!0)])]),t("div",V,[t("div",W,[t("div",A,[e[18]||(e[18]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Sale Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),l.selectedSale?(r(),i("div",j,[t("div",q,[t("div",z,[t("p",null,[e[10]||(e[10]=t("strong",null,"Date:",-1)),h(" "+o(a.formatDate(l.selectedSale.created_at)),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"Customer:",-1)),h(" "+o(l.selectedSale.customer_name||"Walk-in Customer"),1)])]),t("div",H,[t("p",null,[e[12]||(e[12]=t("strong",null,"Payment Method:",-1)),t("span",{class:d(["badge",l.selectedSale.payment_method==="cash"?"bg-success":"bg-primary"])},o(l.selectedSale.payment_method.toUpperCase()),3)])])]),e[17]||(e[17]=t("h6",{class:"mb-3"},"Items",-1)),t("table",Q,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"Product"),t("th",null,"Quantity"),t("th",null,"Unit Price"),t("th",null,"Subtotal")])],-1)),t("tbody",null,[(r(!0),i(m,null,g(l.selectedSale.items,s=>(r(),i("tr",{key:s.id},[t("td",null,o(s.product.name),1),t("td",null,o(s.quantity),1),t("td",null,"৳"+o(a.formatNumber(s.unit_price)),1),t("td",null,"৳"+o(a.formatNumber(s.subtotal)),1)]))),128))])]),t("div",G,[t("div",J,[t("table",K,[t("tr",null,[e[14]||(e[14]=t("td",null,[t("strong",null,"Subtotal:")],-1)),t("td",O,"৳"+o(a.formatNumber(l.selectedSale.subtotal)),1)]),t("tr",null,[e[15]||(e[15]=t("td",null,[t("strong",null,"Tax (10%):")],-1)),t("td",R,"৳"+o(a.formatNumber(l.selectedSale.tax)),1)]),t("tr",X,[e[16]||(e[16]=t("td",null,[t("strong",null,"Total:")],-1)),t("td",Y,"৳"+o(a.formatNumber(l.selectedSale.total_amount)),1)])])])])])):b("",!0)])])],512)])}const nt=y(v,[["render",Z]]);export{nt as default};
