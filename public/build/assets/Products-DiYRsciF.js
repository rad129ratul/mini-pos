import{p as g,c as S}from"./categoryService-B-PhpuPW.js";import{d as l,e,m,F as k,i as C,n as a,o as i,t as d,q,p as u,v as b,y as F,g as P,f as y,r as v}from"./vendor-D4pjJ2_S.js";import{_,u as h}from"./app-9iDwT7xO.js";import{M as x}from"./bootstrap-DDJ2Weqf.js";import"./api-DPQzmjXj.js";const D={name:"ProductList",data(){return{products:[],loading:!1,pagination:{current_page:1,last_page:1,per_page:15,total:0}}},computed:{visiblePages(){const n=[],t=this.pagination.current_page,c=this.pagination.last_page;for(let p=Math.max(1,t-2);p<=Math.min(c,t+2);p++)n.push(p);return n}},mounted(){this.fetchProducts()},methods:{async fetchProducts(n=1){this.loading=!0;try{const t=await g.getAll(n);this.products=t.data,this.pagination={current_page:t.current_page,last_page:t.last_page,per_page:t.per_page,total:t.total}}catch(t){console.error("Error fetching products:",t)}finally{this.loading=!1}},changePage(n){n>=1&&n<=this.pagination.last_page&&this.fetchProducts(n)}},emits:["edit","delete"]},V={key:0,class:"text-center py-5"},E={key:1,class:"text-center py-5"},T={key:2},I={class:"table-responsive"},L={class:"table table-hover align-middle"},N=["src","alt"],U={class:"text-muted"},A={class:"badge bg-secondary"},j={class:"text-primary"},B=["onClick"],z=["onClick"],O={key:0,class:"mt-3"},Q={class:"pagination justify-content-center"},R=["onClick"];function G(n,t,c,p,o,r){return i(),l("div",null,[o.loading?(i(),l("div",V,[...t[2]||(t[2]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):o.products.length===0?(i(),l("div",E,[...t[3]||(t[3]=[e("i",{class:"bi bi-box-seam fs-1 text-muted"},null,-1),e("p",{class:"mt-3 text-muted"},"No products found",-1)])])):(i(),l("div",T,[e("div",I,[e("table",L,[t[7]||(t[7]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{style:{width:"80px"}},"Image"),e("th",null,"Name"),e("th",null,"Category"),e("th",null,"Price"),e("th",null,"Stock"),e("th",{style:{width:"150px"}},"Actions")])],-1)),e("tbody",null,[(i(!0),l(k,null,C(o.products,s=>(i(),l("tr",{key:s.id},[e("td",null,[e("img",{src:s.image||"https://via.placeholder.com/60",alt:s.name,class:"rounded",style:{width:"60px",height:"60px","object-fit":"cover"}},null,8,N)]),e("td",null,[e("strong",null,d(s.name),1),t[4]||(t[4]=e("br",null,null,-1)),e("small",U,d(s.barcode||"No barcode"),1)]),e("td",null,[e("span",A,d(s.category.name),1)]),e("td",null,[e("strong",j,d(s.formatted_price),1)]),e("td",null,[e("span",{class:a(["badge",{"bg-danger":s.stock_quantity===0,"bg-warning":s.stock_quantity>0&&s.stock_quantity<10,"bg-success":s.stock_quantity>=10}])},d(s.stock_quantity),3)]),e("td",null,[e("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:f=>n.$emit("edit",s)},[...t[5]||(t[5]=[e("i",{class:"bi bi-pencil"},null,-1)])],8,B),e("button",{class:"btn btn-sm btn-outline-danger",onClick:f=>n.$emit("delete",s)},[...t[6]||(t[6]=[e("i",{class:"bi bi-trash"},null,-1)])],8,z)])]))),128))])])]),o.pagination.last_page>1?(i(),l("nav",O,[e("ul",Q,[e("li",{class:a(["page-item",{disabled:o.pagination.current_page===1}])},[e("button",{class:"page-link",onClick:t[0]||(t[0]=s=>r.changePage(o.pagination.current_page-1))}," Previous ")],2),(i(!0),l(k,null,C(r.visiblePages,s=>(i(),l("li",{key:s,class:a(["page-item",{active:s===o.pagination.current_page}])},[e("button",{class:"page-link",onClick:f=>r.changePage(s)},d(s),9,R)],2))),128)),e("li",{class:a(["page-item",{disabled:o.pagination.current_page===o.pagination.last_page}])},[e("button",{class:"page-link",onClick:t[1]||(t[1]=s=>r.changePage(o.pagination.current_page+1))}," Next ")],2)])])):m("",!0)]))])}const H=_(D,[["render",G]]),J={name:"ProductForm",props:{product:{type:Object,default:null}},data(){return{modalInstance:null,categories:[],form:{name:"",category_id:"",price:0,cost_price:0,stock_quantity:0,barcode:"",image:"",description:""},errors:{},error:null,loading:!1}},computed:{isEditMode(){return!!this.product}},mounted(){this.modalInstance=new x(this.$refs.modal),this.fetchCategories()},methods:{async fetchCategories(){try{this.categories=await S.getAll()}catch(n){console.error("Failed to load categories:",n)}},show(){this.product?this.form={name:this.product.name,category_id:this.product.category.id,price:this.product.price,cost_price:this.product.cost_price||0,stock_quantity:this.product.stock_quantity,barcode:this.product.barcode||"",image:this.product.image||"",description:this.product.description||""}:this.resetForm(),this.errors={},this.error=null,this.modalInstance.show()},close(){this.modalInstance.hide()},resetForm(){this.form={name:"",category_id:"",price:0,cost_price:0,stock_quantity:0,barcode:"",image:"",description:""},this.errors={},this.error=null},async handleSubmit(){this.loading=!0,this.errors={},this.error=null;try{this.isEditMode?(await g.update(this.product.id,this.form),h().success("Product updated successfully")):(await g.create(this.form),h().success("Product created successfully")),this.$emit("saved"),this.close(),this.resetForm()}catch(n){n.response?.data?.errors?this.errors=n.response.data.errors:this.error=n.response?.data?.message||"Failed to save product"}finally{this.loading=!1}}},emits:["saved"]},K={class:"modal fade",ref:"modal",tabindex:"-1"},W={class:"modal-dialog modal-lg"},X={class:"modal-content"},Y={class:"modal-header"},Z={class:"modal-title"},$={class:"modal-body"},ee={class:"row"},te={class:"col-md-6 mb-3"},se={key:0,class:"invalid-feedback"},oe={class:"col-md-6 mb-3"},re=["value"],ne={key:0,class:"invalid-feedback"},le={class:"col-md-6 mb-3"},ie={key:0,class:"invalid-feedback"},de={class:"col-md-6 mb-3"},ae={key:0,class:"invalid-feedback"},ce={class:"col-md-6 mb-3"},ue={key:0,class:"invalid-feedback"},me={class:"col-md-6 mb-3"},pe={key:0,class:"invalid-feedback"},be={class:"col-12 mb-3"},fe={class:"col-12 mb-3"},ge={key:0,class:"alert alert-danger"},he={class:"modal-footer"},_e=["disabled"],ye=["disabled"],ve={key:0},ke={key:1};function Ce(n,t,c,p,o,r){return i(),l("div",K,[e("div",W,[e("div",X,[e("div",Y,[e("h5",Z,d(r.isEditMode?"Edit Product":"Add New Product"),1),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...s)=>r.close&&r.close(...s))})]),e("form",{onSubmit:t[10]||(t[10]=q((...s)=>r.handleSubmit&&r.handleSubmit(...s),["prevent"]))},[e("div",$,[e("div",ee,[e("div",te,[t[11]||(t[11]=e("label",{class:"form-label"},"Name *",-1)),u(e("input",{type:"text",class:a(["form-control",{"is-invalid":o.errors.name}]),"onUpdate:modelValue":t[1]||(t[1]=s=>o.form.name=s),required:""},null,2),[[b,o.form.name]]),o.errors.name?(i(),l("div",se,d(o.errors.name),1)):m("",!0)]),e("div",oe,[t[13]||(t[13]=e("label",{class:"form-label"},"Category *",-1)),u(e("select",{class:a(["form-select",{"is-invalid":o.errors.category_id}]),"onUpdate:modelValue":t[2]||(t[2]=s=>o.form.category_id=s),required:""},[t[12]||(t[12]=e("option",{value:""},"Select category",-1)),(i(!0),l(k,null,C(o.categories,s=>(i(),l("option",{key:s.id,value:s.id},d(s.name),9,re))),128))],2),[[F,o.form.category_id]]),o.errors.category_id?(i(),l("div",ne,d(o.errors.category_id),1)):m("",!0)]),e("div",le,[t[14]||(t[14]=e("label",{class:"form-label"},"Price (৳) *",-1)),u(e("input",{type:"number",class:a(["form-control",{"is-invalid":o.errors.price}]),"onUpdate:modelValue":t[3]||(t[3]=s=>o.form.price=s),min:"0",step:"0.01",required:""},null,2),[[b,o.form.price,void 0,{number:!0}]]),o.errors.price?(i(),l("div",ie,d(o.errors.price),1)):m("",!0)]),e("div",de,[t[15]||(t[15]=e("label",{class:"form-label"},"Cost Price (৳)",-1)),u(e("input",{type:"number",class:a(["form-control",{"is-invalid":o.errors.cost_price}]),"onUpdate:modelValue":t[4]||(t[4]=s=>o.form.cost_price=s),min:"0",step:"0.01"},null,2),[[b,o.form.cost_price,void 0,{number:!0}]]),o.errors.cost_price?(i(),l("div",ae,d(o.errors.cost_price),1)):m("",!0)]),e("div",ce,[t[16]||(t[16]=e("label",{class:"form-label"},"Stock Quantity *",-1)),u(e("input",{type:"number",class:a(["form-control",{"is-invalid":o.errors.stock_quantity}]),"onUpdate:modelValue":t[5]||(t[5]=s=>o.form.stock_quantity=s),min:"0",required:""},null,2),[[b,o.form.stock_quantity,void 0,{number:!0}]]),o.errors.stock_quantity?(i(),l("div",ue,d(o.errors.stock_quantity),1)):m("",!0)]),e("div",me,[t[17]||(t[17]=e("label",{class:"form-label"},"Barcode",-1)),u(e("input",{type:"text",class:a(["form-control",{"is-invalid":o.errors.barcode}]),"onUpdate:modelValue":t[6]||(t[6]=s=>o.form.barcode=s)},null,2),[[b,o.form.barcode]]),o.errors.barcode?(i(),l("div",pe,d(o.errors.barcode),1)):m("",!0)]),e("div",be,[t[18]||(t[18]=e("label",{class:"form-label"},"Image URL",-1)),u(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=s=>o.form.image=s),placeholder:"https://example.com/image.jpg"},null,512),[[b,o.form.image]])]),e("div",fe,[t[19]||(t[19]=e("label",{class:"form-label"},"Description",-1)),u(e("textarea",{class:"form-control","onUpdate:modelValue":t[8]||(t[8]=s=>o.form.description=s),rows:"3"},null,512),[[b,o.form.description]])])]),o.error?(i(),l("div",ge,d(o.error),1)):m("",!0)]),e("div",he,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[9]||(t[9]=(...s)=>r.close&&r.close(...s)),disabled:o.loading}," Cancel ",8,_e),e("button",{type:"submit",class:"btn btn-primary",disabled:o.loading},[o.loading?(i(),l("span",ve,[...t[20]||(t[20]=[e("span",{class:"spinner-border spinner-border-sm me-2"},null,-1),P(" Saving... ",-1)])])):(i(),l("span",ke,d(r.isEditMode?"Update":"Create")+" Product ",1))],8,ye)])],32)])])],512)}const Pe=_(J,[["render",Ce]]),xe={name:"ConfirmModal",props:{title:{type:String,default:"Confirm Action"},message:{type:String,required:!0},confirmText:{type:String,default:"Confirm"},cancelText:{type:String,default:"Cancel"},danger:{type:Boolean,default:!1}},data(){return{modalInstance:null}},mounted(){this.modalInstance=new x(this.$refs.modal)},methods:{show(){this.modalInstance.show()},hide(){this.modalInstance.hide()},handleConfirm(){this.$emit("confirm"),this.hide()},handleCancel(){this.$emit("cancel"),this.hide()}}},we={class:"modal fade",tabindex:"-1",ref:"modal"},Me={class:"modal-dialog modal-dialog-centered"},Se={class:"modal-content"},qe={class:"modal-title"},Fe={class:"modal-body"},De={class:"mb-0"},Ve={class:"modal-footer"};function Ee(n,t,c,p,o,r){return i(),l("div",we,[e("div",Me,[e("div",Se,[e("div",{class:a(["modal-header",c.danger?"bg-danger text-white":""])},[e("h5",qe,d(c.title),1),e("button",{type:"button",class:a(["btn-close",{"btn-close-white":c.danger}]),onClick:t[0]||(t[0]=(...s)=>r.handleCancel&&r.handleCancel(...s))},null,2)],2),e("div",Fe,[e("p",De,d(c.message),1)]),e("div",Ve,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[1]||(t[1]=(...s)=>r.handleCancel&&r.handleCancel(...s))},d(c.cancelText),1),e("button",{type:"button",class:a(["btn",c.danger?"btn-danger":"btn-primary"]),onClick:t[2]||(t[2]=(...s)=>r.handleConfirm&&r.handleConfirm(...s))},d(c.confirmText),3)])])])],512)}const Te=_(xe,[["render",Ee]]),Ie={name:"Products",components:{ProductList:H,ProductForm:Pe,ConfirmModal:Te},data(){return{selectedProduct:null,productToDelete:null}},methods:{openCreateModal(){this.selectedProduct=null,this.$refs.productForm.show()},openEditModal(n){this.selectedProduct=n,this.$refs.productForm.show()},handleDelete(n){this.productToDelete=n,this.$refs.deleteModal.show()},async confirmDelete(){try{await g.delete(this.productToDelete.id),h().success("Product deleted successfully"),this.$refs.productList.fetchProducts()}catch{h().error("Failed to delete product")}},handleSaved(){this.$refs.productList.fetchProducts()}}},Le={class:"container-fluid"},Ne={class:"d-flex justify-content-between align-items-center mb-4"},Ue={class:"card shadow-sm"},Ae={class:"card-body"};function je(n,t,c,p,o,r){const s=v("ProductList"),f=v("ProductForm"),w=v("ConfirmModal");return i(),l("div",Le,[e("div",Ne,[t[2]||(t[2]=e("h2",{class:"fw-bold"},"Product Management",-1)),e("button",{class:"btn btn-primary btn-lg",onClick:t[0]||(t[0]=(...M)=>r.openCreateModal&&r.openCreateModal(...M))},[...t[1]||(t[1]=[e("i",{class:"bi bi-plus-circle me-2"},null,-1),P(" Add Product ",-1)])])]),e("div",Ue,[e("div",Ae,[y(s,{onEdit:r.openEditModal,onDelete:r.handleDelete,ref:"productList"},null,8,["onEdit","onDelete"])])]),y(f,{ref:"productForm",product:o.selectedProduct,onSaved:r.handleSaved},null,8,["product","onSaved"]),y(w,{ref:"deleteModal",title:"Delete Product",message:"Are you sure you want to delete this product? This action cannot be undone.","confirm-text":"Delete","cancel-text":"Cancel",danger:!0,onConfirm:r.confirmDelete},null,8,["onConfirm"])])}const Ge=_(Ie,[["render",je]]);export{Ge as default};
